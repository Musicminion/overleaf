<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1556px" preserveAspectRatio="none" style="width:1323px;height:1556px;background:#FFFFFF;" version="1.1" viewBox="0 0 1323 1556" width="1323px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="1375.5625" style="stroke:#181818;stroke-width:1.0;" width="10" x="34" y="91.2969"/><rect fill="#FFFFFF" height="1375.5625" style="stroke:#181818;stroke-width:1.0;" width="10" x="315" y="91.2969"/><rect fill="#FFFFFF" height="59.3984" style="stroke:#181818;stroke-width:1.0;" width="10" x="782" y="141.5625"/><rect fill="#FFFFFF" height="834.0156" style="stroke:#181818;stroke-width:1.0;" width="10" x="782" y="521.6406"/><rect fill="#FFFFFF" height="1236.7656" style="stroke:#181818;stroke-width:1.0;" width="10" x="1245" y="230.0938"/><rect fill="none" height="1184.6328" style="stroke:#000000;stroke-width:1.5;" width="1306.5" x="10" y="245.0938"/><rect fill="none" height="1007.0313" style="stroke:#000000;stroke-width:1.5;" width="1049.5" x="257" y="356.625"/><rect fill="none" height="748.75" style="stroke:#000000;stroke-width:1.5;" width="574.5" x="722" y="536.6406"/><rect fill="none" height="408.3359" style="stroke:#000000;stroke-width:1.5;" width="554.5" x="732" y="870.0547"/><rect fill="none" height="131.3359" style="stroke:#000000;stroke-width:1.5;" width="395" x="742" y="1096.1172"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="39" x2="39" y1="81.2969" y2="1475.8594"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="320" x2="320" y1="81.2969" y2="1475.8594"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="787" x2="787" y1="81.2969" y2="1475.8594"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1249.5" x2="1249.5" y1="81.2969" y2="1475.8594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32" x="20" y="77.9951">User</text><ellipse cx="39" cy="13.5" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M39,21.5 L39,48.5 M26,29.5 L52,29.5 M39,48.5 L26,63.5 M39,48.5 L52,63.5 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32" x="20" y="1487.8545">User</text><ellipse cx="39" cy="1499.6563" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M39,1507.6563 L39,1534.6563 M26,1515.6563 L52,1515.6563 M39,1534.6563 L26,1549.6563 M39,1534.6563 L52,1549.6563 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="106" x="267" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92" x="274" y="69.9951">User browser</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="106" x="267" y="1474.8594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92" x="274" y="1494.8545">User browser</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="70" x="752" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="759" y="69.9951">Overleaf</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="70" x="752" y="1474.8594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="759" y="1494.8545">Overleaf</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="53" x="1223.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="1230.5" y="69.9951">Apple</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="53" x="1223.5" y="1474.8594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="1230.5" y="1494.8545">Apple</text><rect fill="#FFFFFF" height="1375.5625" style="stroke:#181818;stroke-width:1.0;" width="10" x="34" y="91.2969"/><rect fill="#FFFFFF" height="1375.5625" style="stroke:#181818;stroke-width:1.0;" width="10" x="315" y="91.2969"/><rect fill="#FFFFFF" height="59.3984" style="stroke:#181818;stroke-width:1.0;" width="10" x="782" y="141.5625"/><rect fill="#FFFFFF" height="834.0156" style="stroke:#181818;stroke-width:1.0;" width="10" x="782" y="521.6406"/><rect fill="#FFFFFF" height="1236.7656" style="stroke:#181818;stroke-width:1.0;" width="10" x="1245" y="230.0938"/><polygon fill="#181818" points="303,108.4297,313,112.4297,303,116.4297,307,112.4297" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="44" x2="309" y1="112.4297" y2="112.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="51" y="107.3638">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178" x="64" y="107.3638">Click to log in through Apple</text><polygon fill="#181818" points="770,137.5625,780,141.5625,770,145.5625,774,141.5625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="325" x2="776" y1="141.5625" y2="141.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="332" y="136.4966">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="224" x="345" y="136.4966">Initiate login request through Apple</text><polygon fill="#181818" points="336,196.9609,326,200.9609,336,204.9609,332,200.9609" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="330" x2="786" y1="200.9609" y2="200.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="342" y="180.7622">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="258" x="355" y="165.6294">302 Redirect to Apple authentication link</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="201" x="355" y="180.7622">attaching client_id、redirect_uri</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154" x="355" y="195.895">scope、response_mode</text><polygon fill="#181818" points="1233,226.0938,1243,230.0938,1233,234.0938,1237,230.0938" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="325" x2="1239" y1="230.0938" y2="230.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="332" y="225.0278">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="348" x="345" y="225.0278">Request Apple login page according to the redirect link</text><path d="M10,245.0938 L74,245.0938 L74,252.2266 L64,262.2266 L10,262.2266 L10,245.0938 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1184.6328" style="stroke:#000000;stroke-width:1.5;" width="1306.5" x="10" y="245.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="25" y="258.1606">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="520" x="89" y="257.3042">[Apple checks the request parameters of the request URL and thinks it is correct]</text><polygon fill="#181818" points="336,279.3594,326,283.3594,336,287.3594,332,283.3594" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="330" x2="1244" y1="283.3594" y2="283.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="342" y="278.2935">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="355" y="278.2935">Return to login page</text><polygon fill="#181818" points="303,308.4922,313,312.4922,303,316.4922,307,312.4922" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="44" x2="309" y1="312.4922" y2="312.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="51" y="307.4263">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="234" x="64" y="307.4263">Enter AppleID and password to log in</text><polygon fill="#181818" points="1233,337.625,1243,341.625,1233,345.625,1237,341.625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="325" x2="1239" y1="341.625" y2="341.625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="332" y="336.5591">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="286" x="345" y="336.5591">Log in according to user name and password</text><path d="M257,356.625 L321,356.625 L321,363.7578 L311,373.7578 L257,373.7578 L257,356.625 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1007.0313" style="stroke:#000000;stroke-width:1.5;" width="1049.5" x="257" y="356.625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="272" y="369.6919">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="483" x="336" y="368.8354">[Apple checks user name and password/two-factor authentication/requests</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="366" x="340" y="381.6401">user authorization information, and an exception occurs]</text><polygon fill="#181818" points="336,401.5,326,405.5,336,409.5,332,405.5" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="330" x2="1244" y1="405.5" y2="405.5"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="342" y="400.4341">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="192" x="355" y="400.4341">返回信息拒绝用户AppleID的登录</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="257" x2="1306.5" y1="414.5" y2="414.5"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="508" x="262" y="424.7104">[Apple checks the user name and password/two-factor authentication/requests</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="522" x="266" y="437.5151">the user authorization information, all of which are passed, and login is allowed]</text><polygon fill="#181818" points="336,473.375,326,477.375,336,481.375,332,477.375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="330" x2="1244" y1="477.375" y2="477.375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="342" y="464.7427">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="480" x="355" y="457.1763">Return authorization code and id_ Token (encrypted user information), user</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="616" x="359" y="472.3091">(clear text user information, such as name, only returned when the user logs in for the first time)</text><polygon fill="#181818" points="770,517.6406,780,521.6406,770,525.6406,774,521.6406" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="325" x2="776" y1="521.6406" y2="521.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="332" y="509.0083">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="416" x="354" y="501.4419">Apple's front-end page sends a POST request to the callback URL</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="337" x="354" y="516.5747">The request body is attached with code, userInfo, etc</text><path d="M722,536.6406 L786,536.6406 L786,543.7734 L776,553.7734 L722,553.7734 L722,536.6406 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="748.75" style="stroke:#000000;stroke-width:1.5;" width="574.5" x="722" y="536.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="737" y="549.7075">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="412" x="801" y="548.8511">[POST request contains user plaintext information and id_ token</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="301" x="801" y="561.6558">(Apple thinks it is a new user of your website)]</text><line style="stroke:#181818;stroke-width:1.0;" x1="792" x2="834" y1="585.5156" y2="585.5156"/><line style="stroke:#181818;stroke-width:1.0;" x1="834" x2="834" y1="585.5156" y2="598.5156"/><line style="stroke:#181818;stroke-width:1.0;" x1="793" x2="834" y1="598.5156" y2="598.5156"/><polygon fill="#181818" points="803,594.5156,793,598.5156,803,602.5156,799,598.5156" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="799" y="580.4497">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="253" x="821" y="580.4497">Record user information(such as name)</text><polygon fill="#181818" points="1233,623.6484,1243,627.6484,1233,631.6484,1237,627.6484" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="792" x2="1239" y1="627.6484" y2="627.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="799" y="622.5825">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="229" x="821" y="622.5825">GET request, get public key of apple</text><polygon fill="#181818" points="803,652.7813,793,656.7813,803,660.7813,799,656.7813" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="797" x2="1244" y1="656.7813" y2="656.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="809" y="651.7153">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184" x="831" y="651.7153">Return public key(three sets)</text><line style="stroke:#181818;stroke-width:1.0;" x1="792" x2="834" y1="685.9141" y2="685.9141"/><line style="stroke:#181818;stroke-width:1.0;" x1="834" x2="834" y1="685.9141" y2="698.9141"/><line style="stroke:#181818;stroke-width:1.0;" x1="793" x2="834" y1="698.9141" y2="698.9141"/><polygon fill="#181818" points="803,694.9141,793,698.9141,803,702.9141,799,698.9141" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="799" y="680.8481">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="417" x="821" y="680.8481">Decryption id_Token and gets the user's unique identifier in Apple</text><line style="stroke:#181818;stroke-width:1.0;" x1="792" x2="834" y1="728.0469" y2="728.0469"/><line style="stroke:#181818;stroke-width:1.0;" x1="834" x2="834" y1="728.0469" y2="741.0469"/><line style="stroke:#181818;stroke-width:1.0;" x1="793" x2="834" y1="741.0469" y2="741.0469"/><polygon fill="#181818" points="803,737.0469,793,741.0469,803,745.0469,799,741.0469" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="799" y="722.981">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="349" x="821" y="722.981">Create a new user and write user data to the database</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="722" x2="1296.5" y1="750.0469" y2="750.0469"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="514" x="727" y="760.2573">[POST request does not contain user clear-text sensitive information, only Code</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="314" x="727" y="773.062">（Apple thinks it is an old user of your website）]</text><line style="stroke:#181818;stroke-width:1.0;" x1="792" x2="834" y1="812.9219" y2="812.9219"/><line style="stroke:#181818;stroke-width:1.0;" x1="834" x2="834" y1="812.9219" y2="825.9219"/><line style="stroke:#181818;stroke-width:1.0;" x1="793" x2="834" y1="825.9219" y2="825.9219"/><polygon fill="#181818" points="803,821.9219,793,825.9219,803,829.9219,799,825.9219" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="799" y="800.2896">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="269" x="821" y="792.7231">Generate client according to XXXXXXXX.p8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125" x="825" y="807.856">key file n_ secret JW</text><polygon fill="#181818" points="1233,851.0547,1243,855.0547,1233,859.0547,1237,855.0547" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="792" x2="1239" y1="855.0547" y2="855.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="799" y="849.9888">17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="389" x="821" y="849.9888">POST request(with code, client_secret and other information)</text><path d="M732,870.0547 L796,870.0547 L796,877.1875 L786,887.1875 L732,887.1875 L732,870.0547 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="408.3359" style="stroke:#000000;stroke-width:1.5;" width="554.5" x="732" y="870.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="747" y="883.1216">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="308" x="811" y="882.2651">[Apple Verify POST Request Parameters Passed]</text><polygon fill="#181818" points="803,904.3203,793,908.3203,803,912.3203,799,908.3203" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="797" x2="1244" y1="908.3203" y2="908.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="809" y="903.2544">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172" x="831" y="903.2544">Return encrypted id_ token</text><polygon fill="#181818" points="1233,933.4531,1243,937.4531,1233,941.4531,1237,937.4531" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="792" x2="1239" y1="937.4531" y2="937.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="799" y="932.3872">19</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="200" x="821" y="932.3872">GET request public key of apple</text><polygon fill="#181818" points="803,962.5859,793,966.5859,803,970.5859,799,966.5859" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="797" x2="1244" y1="966.5859" y2="966.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="809" y="961.52">20</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184" x="831" y="961.52">Return public key(three sets)</text><line style="stroke:#181818;stroke-width:1.0;" x1="792" x2="834" y1="1010.8516" y2="1010.8516"/><line style="stroke:#181818;stroke-width:1.0;" x1="834" x2="834" y1="1010.8516" y2="1023.8516"/><line style="stroke:#181818;stroke-width:1.0;" x1="793" x2="834" y1="1023.8516" y2="1023.8516"/><polygon fill="#181818" points="803,1019.8516,793,1023.8516,803,1027.8516,799,1023.8516" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="799" y="998.2192">21</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="318" x="821" y="990.6528">Select a matching public key decryption id_ Token</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="318" x="825" y="1005.7856">Get user information (including email information)</text><line style="stroke:#181818;stroke-width:1.0;" x1="792" x2="834" y1="1068.1172" y2="1068.1172"/><line style="stroke:#181818;stroke-width:1.0;" x1="834" x2="834" y1="1068.1172" y2="1081.1172"/><line style="stroke:#181818;stroke-width:1.0;" x1="793" x2="834" y1="1081.1172" y2="1081.1172"/><polygon fill="#181818" points="803,1077.1172,793,1081.1172,803,1085.1172,799,1081.1172" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="799" y="1055.4849">22</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="304" x="821" y="1047.9185">Find users in the database according to the sub</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="382" x="821" y="1063.0513">(Apple user unique identifier) that decrypts user information</text><path d="M742,1096.1172 L806,1096.1172 L806,1103.25 L796,1113.25 L742,1113.25 L742,1096.1172 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="131.3359" style="stroke:#000000;stroke-width:1.5;" width="395" x="742" y="1096.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="757" y="1109.1841">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="264" x="821" y="1108.3276">[No user found in the Overleaf database]</text><line style="stroke:#181818;stroke-width:1.0;" x1="792" x2="834" y1="1149.5156" y2="1149.5156"/><line style="stroke:#181818;stroke-width:1.0;" x1="834" x2="834" y1="1149.5156" y2="1162.5156"/><line style="stroke:#181818;stroke-width:1.0;" x1="793" x2="834" y1="1162.5156" y2="1162.5156"/><polygon fill="#181818" points="803,1158.5156,793,1162.5156,803,1166.5156,799,1162.5156" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="799" y="1136.8833">23</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="286" x="821" y="1129.3169">This is unlikely to happen, but it is still written</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="304" x="821" y="1144.4497">Create user (SubID, mailbox), write to database</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="742" x2="1137" y1="1171.5156" y2="1171.5156"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="304" x="747" y="1181.7261">[This user was found in the Overleaf database]</text><line style="stroke:#181818;stroke-width:1.0;" x1="792" x2="834" y1="1206.4531" y2="1206.4531"/><line style="stroke:#181818;stroke-width:1.0;" x1="834" x2="834" y1="1206.4531" y2="1219.4531"/><line style="stroke:#181818;stroke-width:1.0;" x1="793" x2="834" y1="1219.4531" y2="1219.4531"/><polygon fill="#181818" points="803,1215.4531,793,1219.4531,803,1223.4531,799,1219.4531" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="799" y="1201.3872">24</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141" x="821" y="1201.3872">Read user information</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="732" x2="1286.5" y1="1235.4531" y2="1235.4531"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="312" x="737" y="1245.6636">[Apple failed to verify POST request parameters]</text><polygon fill="#181818" points="803,1266.3906,793,1270.3906,803,1274.3906,799,1270.3906" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="797" x2="1244" y1="1270.3906" y2="1270.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="809" y="1265.3247">25</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="226" x="831" y="1265.3247">Return parameter error information</text><line style="stroke:#181818;stroke-width:1.0;" x1="792" x2="834" y1="1313.5234" y2="1313.5234"/><line style="stroke:#181818;stroke-width:1.0;" x1="834" x2="834" y1="1313.5234" y2="1326.5234"/><line style="stroke:#181818;stroke-width:1.0;" x1="793" x2="834" y1="1326.5234" y2="1326.5234"/><polygon fill="#181818" points="803,1322.5234,793,1326.5234,803,1330.5234,799,1326.5234" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="799" y="1308.4575">26</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="229" x="821" y="1308.4575">Complete the login completion work</text><polygon fill="#181818" points="336,1351.6563,326,1355.6563,336,1359.6563,332,1355.6563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="330" x2="786" y1="1355.6563" y2="1355.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="342" y="1350.5903">27</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193" x="364" y="1350.5903">Return login result information</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="1316.5" y1="1371.6563" y2="1371.6563"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="470" x="15" y="1381.8667">[Apple checks the request parameters of the URL and considers it illegal]</text><polygon fill="#181818" points="336,1417.7266,326,1421.7266,336,1425.7266,332,1421.7266" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="330" x2="1244" y1="1421.7266" y2="1421.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="342" y="1409.0942">28</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="425" x="364" y="1401.5278">Return to the error information page, such as missing parameters,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="331" x="364" y="1416.6606">parameter errors, and parameter illegal information</text><polygon fill="#181818" points="55,1453.8594,45,1457.8594,55,1461.8594,51,1457.8594" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="49" x2="314" y1="1457.8594" y2="1457.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="61" y="1452.7935">29</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177" x="83" y="1452.7935">Inform users of login results</text></g></svg>